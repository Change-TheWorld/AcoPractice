<!-- 阮一峰JS教程阅读札记之JS语法篇 -->

# 开篇

这些JS系列博客是记录我阅读 阮一峰老师的[`《JavaScript 标准参考教程（alpha）》`](http://javascript.ruanyifeng.com/)  的札记，受益良多，所以就把我学到的，感悟到的一些东西记录下来，不会复制粘贴，只记录`重点`和`感悟`。

书里有句话，我非常喜欢，`“我想写这本书，主要原因是自己需要。遇到问题，我首先查自己的笔记，如果笔记里没有，再到网上查，最后回过头把笔记补全。终于有一天，我意识到可以把笔记做成书，这就是这本书的由来。”`

# 前言

1995年5月，Brendan Eich只用了10天，就设计完成了这种语言的第一版。它是一个大杂烩，语法有多个来源：

> 基本语法：借鉴C语言和Java语言。(JavaScript这个名字的原意是“很像Java的脚本语言”。)
> 数据结构：借鉴Java语言，包括将值分成原始值和对象两大类。
> 函数的用法：借鉴Scheme语言和Awk语言，将函数当作第一等公民，并引入闭包。
> 原型继承模型：借鉴Self语言（Smalltalk的一种变种）。
> 正则表达式：借鉴Perl语言。
> 字符串和数组处理：借鉴Python语言。

由于来源多样，从一开始就注定，JavaScript的编程风格是函数式编程和面向对象编程的一种混合体。

JavaScript 是一种轻量级的，嵌入式（embedded）的脚本语言。它本身不提供任何与 I/O（输入/输出）相关的 API，都要靠宿主环境（host）提供。它是目前唯一一种通用的浏览器脚本语言，所有浏览器都支持。

宿主环境有两种： `浏览器` 和 `Node 项目(服务器环境)`。

JS 的灵活性体现在： **JavaScript 并不是纯粹的 “面向对象语言”，还支持其他编程范式（比如函数式编程）**, 既能面向对象编程，比如es6里引入的经典的 `class`等标志性的语法，也支持类似 C 语言清晰的过程式编程，也支持灵活的函数式编程。

JavaScript 语言本身，虽然是一种 `解释型语言`，但是在现代浏览器中，JavaScript 都是 `编译后运行`。程序会被高度优化，`运行效率接近二进制程序`。而且，JavaScript 引擎正在快速发展，性能将越来越好。（JS v8 引擎，有兴趣的可以去知乎上看一下 justjavac 的相关回答）

ECMAScript和JavaScript的关系是，前者是后者的规格，后者是前者的一种实现。

基本上，JavaScript这个名字的原意是“很像Java的脚本语言”。在JavaScript语言中，函数是一种独立的数据类型，以及采用基于原型对象（prototype）的继承链。这是它与Java语法最大的两点区别。另外，Java语言需要编译，而JavaScript语言则是运行时由解释器直接执行。

# 语法

JavaScript 的所有值都是对象。

这里只记录比较重要的语法点，想看详细的可以去看[阮老师的教程](http://javascript.ruanyifeng.com/)。

## 基础语法

### 标识符命名规则

很多人的 JS 里变量名随便起，其实是有问题的，我的导师教过我一句话： `“一个好的命名效果是，即使一个完全不懂程序的人去看你的代码，也知道那个变量指的是什么意思。”`

基本规则：

1. 第一个字符，可以是任意Unicode字母（包括英文字母和其他语言的字母），以及美元符号（$）和下划线（_）。不能是数字！
2. 第二个字符及后面的字符，除了Unicode字母、美元符号和下划线，还可以用数字0-9。
3. 标识符里不能有 `* + / - ^ % # & @`等等特殊字符。
4. `**要有意义！**`.
5. 中文也可以做为标识符（不建议使用，最好使用英文）
6. 这三个词虽然不是保留字，但是因为具有特别含义，也不应该用作标识符：`Infinity`、`NaN`、`undefined`。
7. 一些保留字不能用作标识符，如下：

> JavaScript保留字：arguments、break、case、catch、class、const、continue、debugger、default、delete、do、else、enum、eval、export、extends、false、finally、for、function、if、implements、import、in、instanceof、interface、let、new、null、package、private、protected、public、return、static、super、switch、this、throw、true、try、typeof、var、void、while、with、yield。

建议总是使用 var/let 命令声明变量。如果不声明却直接赋值，不仅不利于表达意图，而且不知不觉就会创建一个全局变量。

> 严格地说，var a = 1 与 a = 1，这两条语句的效果不完全一样，主要体现在delete命令无法删除前者。不过，绝大多数情况下，这种差异是可以忽略的。

### 变量提升

JavaScript引擎的工作方式是，`先解析代码，获取所有被声明的变量`，然后再`一行一行地运行`。于是所有的变量的声明语句，都会被提升到代码的头部。

`注意：变量提升只对 var 命令声明的变量有效，如果一个变量不是用var命令声明的，就不会发生变量提升。`

### js 里的作用域

这里有一个很重要的概念——`区块`，JavaScript使用`大括号，将多个相关的语句组合在一起`，称为“区块”（block）。

`区块中的变量与区块外的变量，属于同一个作用域`。这说明区块不构成单独的作用域，与 `不使用区块的情况没有任何区别`。区块往往用来构成其他更复杂的语法结构，比如`for、if、while、function`等。

建议总是在 if 语句中使用大括号，因为这样方便插入语句。

### 标签（label）

JavaScript语言允许，语句的前面有标签（label），相当于定位符，用于跳转到程序的任意位置

```js
top1:
  for (var i = 0; i < 3; i++) {
    for (var j = 0; j < 3; j++) {
      if (i === 1 && j === 1)
        break top1;
      console.log('i=' + i + ', j=' + j);
    }
  }
// i=0, j=0
// i=0, j=1
// i=0, j=2
// i=1, j=0
```

break命令后面加上了top标签（注意，top不用加引号），满足条件时，直接跳出双层循环。如果break语句后面不使用标签，则只能跳出内层循环，进入下一次的外层循环。

```js
top2:
  for (var i = 0; i < 3; i++) {
    for (var j = 0; j < 3; j++){
      if (i === 1 && j === 1)
        continue top2;
      console.log('i=' + i + ', j=' + j);
    }
  }
// i=0, j=0
// i=0, j=1
// i=0, j=2
// i=1, j=0
// i=2, j=0
// i=2, j=1
// i=2, j=2

```

continue命令后面有一个标签名，满足条件时，会跳过当前循环，直接进入下一轮外层循环。如果continue语句后面不使用标签，则只能进入下一轮的内层循环。

### 其他

`**注意**`: 优先采用 “严格相等运算符”（`===`），而不是“相等运算符”（`==`）。

`switch` 语句后面的表达式与 `case1` 语句后面的表示式，在比较运行结果时，采用的是严格相等运算符（`===`），而不是相等运算符（`==`），这意味着比较时不会发生类型转换。

不管条件是否为真，do..while 循环至少运行一次，这是这种结构最大的特点。另外，while 语句后面的分号不能省略。
